$PBExportHeader$w_test.srw
forward
global type w_test from window
end type
type tab_1 from tab within w_test
end type
type tabpage_list from userobject within tab_1
end type
type ddlb_sort_datatype from dropdownlistbox within tabpage_list
end type
type st_3 from statictext within tabpage_list
end type
type ddlb_datatype from dropdownlistbox within tabpage_list
end type
type cbx_null from checkbox within tabpage_list
end type
type cb_sort from commandbutton within tabpage_list
end type
type cb_multibench from commandbutton within tabpage_list
end type
type sle_data from singlelineedit within tabpage_list
end type
type st_2 from statictext within tabpage_list
end type
type cb_prepend from commandbutton within tabpage_list
end type
type cb_get from commandbutton within tabpage_list
end type
type cb_delete from commandbutton within tabpage_list
end type
type cb_obj from commandbutton within tabpage_list
end type
type cb_1 from commandbutton within tabpage_list
end type
type st_count from statictext within tabpage_list
end type
type cb_purge from commandbutton within tabpage_list
end type
type cb_set from commandbutton within tabpage_list
end type
type lb_values from listbox within tabpage_list
end type
type st_max from statictext within tabpage_list
end type
type st_idx from statictext within tabpage_list
end type
type sle_index from singlelineedit within tabpage_list
end type
type pb_rewind from picturebutton within tabpage_list
end type
type pb_prev from picturebutton within tabpage_list
end type
type pb_next from picturebutton within tabpage_list
end type
type cb_first from commandbutton within tabpage_list
end type
type cb_last from commandbutton within tabpage_list
end type
type cb_append from commandbutton within tabpage_list
end type
type cb_insert from commandbutton within tabpage_list
end type
type cb_before from commandbutton within tabpage_list
end type
type cb_after from commandbutton within tabpage_list
end type
type cbx_hasnext from checkbox within tabpage_list
end type
type sle_testcount from singlelineedit within tabpage_list
end type
type st_x from statictext within tabpage_list
end type
type cb_bench from commandbutton within tabpage_list
end type
type st_time from statictext within tabpage_list
end type
type gb_1 from groupbox within tabpage_list
end type
type gb_3 from groupbox within tabpage_list
end type
type tabpage_list from userobject within tab_1
ddlb_sort_datatype ddlb_sort_datatype
st_3 st_3
ddlb_datatype ddlb_datatype
cbx_null cbx_null
cb_sort cb_sort
cb_multibench cb_multibench
sle_data sle_data
st_2 st_2
cb_prepend cb_prepend
cb_get cb_get
cb_delete cb_delete
cb_obj cb_obj
cb_1 cb_1
st_count st_count
cb_purge cb_purge
cb_set cb_set
lb_values lb_values
st_max st_max
st_idx st_idx
sle_index sle_index
pb_rewind pb_rewind
pb_prev pb_prev
pb_next pb_next
cb_first cb_first
cb_last cb_last
cb_append cb_append
cb_insert cb_insert
cb_before cb_before
cb_after cb_after
cbx_hasnext cbx_hasnext
sle_testcount sle_testcount
st_x st_x
cb_bench cb_bench
st_time st_time
gb_1 gb_1
gb_3 gb_3
end type
type tabpage_vector from userobject within tab_1
end type
type ddlb_sort_datatype_vect from dropdownlistbox within tabpage_vector
end type
type st_4 from statictext within tabpage_vector
end type
type ddlb_datatype_vect from dropdownlistbox within tabpage_vector
end type
type cbx_null_vect from checkbox within tabpage_vector
end type
type cb_sort_v from commandbutton within tabpage_vector
end type
type cb_multibench_v from commandbutton within tabpage_vector
end type
type cbx_reserve from checkbox within tabpage_vector
end type
type st_time_v from statictext within tabpage_vector
end type
type cb_bench_v from commandbutton within tabpage_vector
end type
type st_6 from statictext within tabpage_vector
end type
type sle_testcount_v from singlelineedit within tabpage_vector
end type
type cbx_hasnext_v from checkbox within tabpage_vector
end type
type cb_after_v from commandbutton within tabpage_vector
end type
type cb_before_v from commandbutton within tabpage_vector
end type
type cb_insert_v from commandbutton within tabpage_vector
end type
type cb_append_v from commandbutton within tabpage_vector
end type
type cb_last_v from commandbutton within tabpage_vector
end type
type cb_first_v from commandbutton within tabpage_vector
end type
type pb_next_v from picturebutton within tabpage_vector
end type
type pb_prev_v from picturebutton within tabpage_vector
end type
type pb_rewind_v from picturebutton within tabpage_vector
end type
type sle_index_v from singlelineedit within tabpage_vector
end type
type st_5 from statictext within tabpage_vector
end type
type st_max_v from statictext within tabpage_vector
end type
type lb_values_v from listbox within tabpage_vector
end type
type cb_set_v from commandbutton within tabpage_vector
end type
type cb_purge_v from commandbutton within tabpage_vector
end type
type st_count_v from statictext within tabpage_vector
end type
type cb_debug_v from commandbutton within tabpage_vector
end type
type cb_5 from commandbutton within tabpage_vector
end type
type cb_delete_v from commandbutton within tabpage_vector
end type
type cb_get_v from commandbutton within tabpage_vector
end type
type cb_prepend_v from commandbutton within tabpage_vector
end type
type st_1 from statictext within tabpage_vector
end type
type sle_data_v from singlelineedit within tabpage_vector
end type
type gb_2 from groupbox within tabpage_vector
end type
type gb_index from groupbox within tabpage_vector
end type
type tabpage_vector from userobject within tab_1
ddlb_sort_datatype_vect ddlb_sort_datatype_vect
st_4 st_4
ddlb_datatype_vect ddlb_datatype_vect
cbx_null_vect cbx_null_vect
cb_sort_v cb_sort_v
cb_multibench_v cb_multibench_v
cbx_reserve cbx_reserve
st_time_v st_time_v
cb_bench_v cb_bench_v
st_6 st_6
sle_testcount_v sle_testcount_v
cbx_hasnext_v cbx_hasnext_v
cb_after_v cb_after_v
cb_before_v cb_before_v
cb_insert_v cb_insert_v
cb_append_v cb_append_v
cb_last_v cb_last_v
cb_first_v cb_first_v
pb_next_v pb_next_v
pb_prev_v pb_prev_v
pb_rewind_v pb_rewind_v
sle_index_v sle_index_v
st_5 st_5
st_max_v st_max_v
lb_values_v lb_values_v
cb_set_v cb_set_v
cb_purge_v cb_purge_v
st_count_v st_count_v
cb_debug_v cb_debug_v
cb_5 cb_5
cb_delete_v cb_delete_v
cb_get_v cb_get_v
cb_prepend_v cb_prepend_v
st_1 st_1
sle_data_v sle_data_v
gb_2 gb_2
gb_index gb_index
end type
type tab_1 from tab within w_test
tabpage_list tabpage_list
tabpage_vector tabpage_vector
end type
end forward

global type w_test from window
integer width = 3090
integer height = 1772
boolean titlebar = true
string title = "PBNI ListTest"
string menuname = "m_main"
boolean controlmenu = true
boolean minbox = true
boolean maxbox = true
long backcolor = 67108864
string icon = "list.ico"
boolean center = true
tab_1 tab_1
end type
global w_test w_test

type prototypes
Subroutine OutputDebugString (String lpszOutputString)  LIBRARY "kernel32.dll" ALIAS FOR "OutputDebugStringW";

end prototypes

type variables


uo_list list
uo_vector vector
string is_keys[]

string is_loops = "10|100|1000|5000|10000|50000|100000|250000|500000|750000|1000000"
n_tooltip i_actTip

end variables

forward prototypes
public subroutine list_data ()
public function window thiswindow ()
public function integer cmplist (any aa_one, any aa_two)
public function integer cmpvector (any aa_one, any aa_two)
public function any get_data ()
public function string tostring (any aa_val)
public subroutine of_addtips ()
public subroutine of_removetips ()
public function string of_get_tag (powerobject apo_obj)
public function string of_datatypeof (powerobject apo_object)
public subroutine show_data (any aa_val, singlelineedit a_sle, dropdownlistbox a_ddlb)
end prototypes

public subroutine list_data ();////string keys[]
int i, size
long ll_pos
string ls_val
any item

choose case tab_1.selectedtab
	case 1
		size = list.size()
		ll_pos = list.position( )
		tab_1.tabpage_list.st_count.text = "items :" + string(size)
		
		tab_1.tabpage_list.lb_values.reset()
		for i = 1 to size
			item = list.getat(i)
			ls_val = tostring(item)
			ls_val = ls_val + ' [' + classname(item) + ']'
			if i = ll_pos then
				ls_val = "->"+ls_val
			else
				ls_val = "  "+ls_val
			end if
			tab_1.tabpage_list.lb_values.additem(ls_val)
		next
		
		tab_1.tabpage_list.cbx_hasnext.checked = list.hasnext()
		
	case 2
		size = vector.size()
		ll_pos = vector.position( )
		tab_1.tabpage_vector.st_count_v.text = "items :" + string(size)
		
		tab_1.tabpage_vector.lb_values_v.reset()
		for i = 1 to size
			item = vector.getat(i)
			ls_val = tostring( item )
			ls_val = ls_val + ' [' + classname(item) + ']'
			if i = ll_pos then
				ls_val = "->"+ls_val
			else
				ls_val = "  "+ls_val
			end if
			tab_1.tabpage_vector.lb_values_v.additem(ls_val)
		next
		
		tab_1.tabpage_vector.cbx_hasnext_v.checked = vector.hasnext()
		
end choose

end subroutine

public function window thiswindow ();return this

end function

public function integer cmplist (any aa_one, any aa_two);int ret

any a,b

choose case tab_1.tabpage_list.ddlb_sort_datatype.text
	case "string"
		a = string(aa_one)
		b = string(aa_two)
	case "integer"
		a = integer( aa_one )
		b = integer( aa_two )
	case "long"
		a = long( aa_one )
		b = long( aa_two )
	case "date"
		a = date( aa_one )
		b = date( aa_two )
	case "datetime"
		a = datetime( aa_one )
		b = datetime( aa_two )
	case "time"
		a = time( aa_one )
		b = time( aa_two )
	case "decimal"
		a = dec( aa_one )
		b = dec( aa_two )
	case else	//Object
		a = classname( aa_one )
		b = classname( aa_two )
end choose

if a < b then
	ret = -1
else
	ret = 0
end if

return ret

end function

public function integer cmpvector (any aa_one, any aa_two);int ret

any a,b

choose case tab_1.tabpage_vector.ddlb_sort_datatype_vect.text
	case "string"
		a = string(aa_one)
		b = string(aa_two)
	case "integer"
		a = integer( aa_one )
		b = integer( aa_two )
	case "long"
		a = long( aa_one )
		b = long( aa_two )
	case "date"
		a = date( aa_one )
		b = date( aa_two )
	case "datetime"
		a = datetime( aa_one )
		b = datetime( aa_two )
	case "time"
		a = time( aa_one )
		b = time( aa_two )
	case "decimal"
		a = dec( aa_one )
		b = dec( aa_two )
	case else	//Object
		a = classname( aa_one )
		b = classname( aa_two )
end choose

if a < b then
	ret = -1
else
	ret = 0
end if

return ret

end function

public function any get_data ();
any la_val	
string ls_datatype, ls_val

if tab_1.selectedtab = 1 then
	//LIST
	if tab_1.tabpage_list.cbx_null.checked then
		setnull( la_val )
		return la_val
	else
		ls_val = tab_1.tabpage_list.sle_data.text
		ls_datatype = tab_1.tabpage_list.ddlb_datatype.text
	end if
else
	//VECTOR
	if tab_1.tabpage_vector.cbx_null_vect.checked then
		setnull( la_val )
		return la_val
	else
		ls_val = tab_1.tabpage_vector.sle_data_v.text
		ls_datatype = tab_1.tabpage_vector.ddlb_datatype_vect.text
	end if	
end if

choose case ls_datatype
	case "string"	; la_val = ls_val
	case "integer" ; la_val = integer( ls_val )
	case "long"	 ; la_val = long( ls_val )
	case "date"	; la_val = date( ls_val )
	case "datetime"	; la_val = datetime( ls_val )
	case "time"		; la_val = time( ls_val )
	case "decimal"	; la_val = dec( ls_val )
	case else	//"object"
		//requiere CWGetField()
		string ls_class
		ls_class=string(ls_val)
		la_val = create using ls_class
end choose
return la_val
end function

public function string tostring (any aa_val);
//cast an any to a readable string

if isnull( aa_val ) then return "<null>"

choose case classname( aa_val )
	case "string", "integer", "int", "unsigned integer", "uint", "date", "datetime", "time", "decimal", &
			"double", "real","long", "unsigned long", "ulong"
		return string( aa_val )
end choose

return classname( aa_val )
		
end function

public subroutine of_addtips ();

//i_actTip.of_SetTipTitle(i_actTip.TTI_INFO, "PCRE pattern option")

int i, p
string ls_tag
powerobject item
for i = 1 to upperbound(tab_1.tabpage_list.control[])
	item = tab_1.tabpage_list.control[i]
	ls_tag = of_get_tag( item )
	p = pos(ls_tag, "TT:")
	if p > 0 then
		i_actTip.of_addtool( item, mid(ls_tag, p + 3), i_actTip.TTF_SUBCLASS)
	end if
next

end subroutine

public subroutine of_removetips ();
i_actTip.of_removealltools( )
end subroutine

public function string of_get_tag (powerobject apo_obj);//return the tag value of the currenct object
string ls_tag
choose case of_datatypeof( apo_obj )
	case "window"
		window l_window
		l_window = apo_obj
		ls_tag = l_window.tag			
	case "dragobject"
		dragobject l_object
		l_object = apo_obj
		ls_tag = l_object.tag
	case "roundrectangle"
		roundrectangle l_rr
		l_rr = apo_obj
		ls_tag = l_rr.tag		
	case else
		debug_message( classname(), "of_get_tag :  type not handled = " + of_datatypeof( apo_obj ) )
end choose

return ls_tag

end function

public function string of_datatypeof (powerobject apo_object);classdefinition lcd_classdef
lcd_classdef = apo_object.classdefinition
string ls_datatype
choose case lcd_classdef.datatypeof
	case "commandbutton", "vprogressbar", "vtrackbar", "statichyperlink", "singlelineedit", "statictext", &
		"picturebutton", "checkbox", "datawindow", "radiobutton", "inkedit", "inkpicture", "animation", &
		"groupbox", "datepicker", "olecustomcontrol", "treeview", "listview", "graph", "monthcalendar", &
		"listbox", "dropdownlistbox", "picturelistbox", "dropdownpicturelistbox", "picture", "picturehyperlink",&
		"hscrollbar", "vscrollbar", "hprogressbar", "htrackbar", "editmask", "richtextedit", "multilineedit"
		ls_datatype = "dragobject"		
	case "tab", "userobject"
		ls_datatype = "dragobject"
	case else
		ls_datatype = lcd_classdef.datatypeof
end choose
return ls_datatype

end function

public subroutine show_data (any aa_val, singlelineedit a_sle, dropdownlistbox a_ddlb);
a_sle.text = tostring(aa_val)
a_ddlb.selectitem(classname(aa_val), 0)

end subroutine

event open;
list = create uo_list
vector = create uo_vector

tab_1.tabpage_list.gb_1.text = "Version : " + list.getversion()
tab_1.tabpage_list.st_count.text = "items :" + string(list.size())
tab_1.tabpage_list.st_max.text = "max = " + string(list.maxsize( ))
tab_1.tabpage_vector.gb_2.text = "Version : " + vector.getversion()
tab_1.tabpage_vector.st_count_v.text = "items :" + string(vector.size())
tab_1.tabpage_vector.st_max_v.text = "max = " + string(vector.maxsize( ))

tab_1.tabpage_list.ddlb_datatype.selectitem("string", 0)
tab_1.tabpage_vector.ddlb_datatype_vect.selectitem("string", 0)

of_addtips( )

end event

event close;
if isvalid(list) then destroy list
if isvalid(vector) then destroy vector


end event

on w_test.create
if this.MenuName = "m_main" then this.MenuID = create m_main
this.tab_1=create tab_1
this.Control[]={this.tab_1}
end on

on w_test.destroy
if IsValid(MenuID) then destroy(MenuID)
destroy(this.tab_1)
end on

event timer;
beep(1)
yield()
end event

type tab_1 from tab within w_test
event create ( )
event destroy ( )
integer x = 27
integer y = 24
integer width = 3022
integer height = 1648
integer taborder = 10
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long backcolor = 67108864
boolean raggedright = true
boolean focusonbuttondown = true
integer selectedtab = 1
tabpage_list tabpage_list
tabpage_vector tabpage_vector
end type

on tab_1.create
this.tabpage_list=create tabpage_list
this.tabpage_vector=create tabpage_vector
this.Control[]={this.tabpage_list,&
this.tabpage_vector}
end on

on tab_1.destroy
destroy(this.tabpage_list)
destroy(this.tabpage_vector)
end on

type tabpage_list from userobject within tab_1
event create ( )
event destroy ( )
event show_data ( any aa_val )
integer x = 18
integer y = 112
integer width = 2985
integer height = 1520
long backcolor = 67108864
string text = "uo_list"
long tabtextcolor = 33554432
long picturemaskcolor = 536870912
ddlb_sort_datatype ddlb_sort_datatype
st_3 st_3
ddlb_datatype ddlb_datatype
cbx_null cbx_null
cb_sort cb_sort
cb_multibench cb_multibench
sle_data sle_data
st_2 st_2
cb_prepend cb_prepend
cb_get cb_get
cb_delete cb_delete
cb_obj cb_obj
cb_1 cb_1
st_count st_count
cb_purge cb_purge
cb_set cb_set
lb_values lb_values
st_max st_max
st_idx st_idx
sle_index sle_index
pb_rewind pb_rewind
pb_prev pb_prev
pb_next pb_next
cb_first cb_first
cb_last cb_last
cb_append cb_append
cb_insert cb_insert
cb_before cb_before
cb_after cb_after
cbx_hasnext cbx_hasnext
sle_testcount sle_testcount
st_x st_x
cb_bench cb_bench
st_time st_time
gb_1 gb_1
gb_3 gb_3
end type

on tabpage_list.create
this.ddlb_sort_datatype=create ddlb_sort_datatype
this.st_3=create st_3
this.ddlb_datatype=create ddlb_datatype
this.cbx_null=create cbx_null
this.cb_sort=create cb_sort
this.cb_multibench=create cb_multibench
this.sle_data=create sle_data
this.st_2=create st_2
this.cb_prepend=create cb_prepend
this.cb_get=create cb_get
this.cb_delete=create cb_delete
this.cb_obj=create cb_obj
this.cb_1=create cb_1
this.st_count=create st_count
this.cb_purge=create cb_purge
this.cb_set=create cb_set
this.lb_values=create lb_values
this.st_max=create st_max
this.st_idx=create st_idx
this.sle_index=create sle_index
this.pb_rewind=create pb_rewind
this.pb_prev=create pb_prev
this.pb_next=create pb_next
this.cb_first=create cb_first
this.cb_last=create cb_last
this.cb_append=create cb_append
this.cb_insert=create cb_insert
this.cb_before=create cb_before
this.cb_after=create cb_after
this.cbx_hasnext=create cbx_hasnext
this.sle_testcount=create sle_testcount
this.st_x=create st_x
this.cb_bench=create cb_bench
this.st_time=create st_time
this.gb_1=create gb_1
this.gb_3=create gb_3
this.Control[]={this.ddlb_sort_datatype,&
this.st_3,&
this.ddlb_datatype,&
this.cbx_null,&
this.cb_sort,&
this.cb_multibench,&
this.sle_data,&
this.st_2,&
this.cb_prepend,&
this.cb_get,&
this.cb_delete,&
this.cb_obj,&
this.cb_1,&
this.st_count,&
this.cb_purge,&
this.cb_set,&
this.lb_values,&
this.st_max,&
this.st_idx,&
this.sle_index,&
this.pb_rewind,&
this.pb_prev,&
this.pb_next,&
this.cb_first,&
this.cb_last,&
this.cb_append,&
this.cb_insert,&
this.cb_before,&
this.cb_after,&
this.cbx_hasnext,&
this.sle_testcount,&
this.st_x,&
this.cb_bench,&
this.st_time,&
this.gb_1,&
this.gb_3}
end on

on tabpage_list.destroy
destroy(this.ddlb_sort_datatype)
destroy(this.st_3)
destroy(this.ddlb_datatype)
destroy(this.cbx_null)
destroy(this.cb_sort)
destroy(this.cb_multibench)
destroy(this.sle_data)
destroy(this.st_2)
destroy(this.cb_prepend)
destroy(this.cb_get)
destroy(this.cb_delete)
destroy(this.cb_obj)
destroy(this.cb_1)
destroy(this.st_count)
destroy(this.cb_purge)
destroy(this.cb_set)
destroy(this.lb_values)
destroy(this.st_max)
destroy(this.st_idx)
destroy(this.sle_index)
destroy(this.pb_rewind)
destroy(this.pb_prev)
destroy(this.pb_next)
destroy(this.cb_first)
destroy(this.cb_last)
destroy(this.cb_append)
destroy(this.cb_insert)
destroy(this.cb_before)
destroy(this.cb_after)
destroy(this.cbx_hasnext)
destroy(this.sle_testcount)
destroy(this.st_x)
destroy(this.cb_bench)
destroy(this.st_time)
destroy(this.gb_1)
destroy(this.gb_3)
end on

event show_data(any aa_val);
show_data(aa_val, sle_data, ddlb_datatype)

end event

type ddlb_sort_datatype from dropdownlistbox within tabpage_list
string tag = "TT:Datatype used for comparison during sort."
integer x = 978
integer y = 964
integer width = 498
integer height = 556
integer taborder = 80
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
boolean sorted = false
boolean vscrollbar = true
string item[] = {"string","integer","long","date","datetime","time","decimal","object (use path-name)"}
borderstyle borderstyle = stylelowered!
end type

event constructor;this.selectitem( 1 )
end event

type st_3 from statictext within tabpage_list
integer x = 114
integer y = 320
integer width = 343
integer height = 68
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
long backcolor = 67108864
string text = "data type:"
boolean focusrectangle = false
end type

type ddlb_datatype from dropdownlistbox within tabpage_list
integer x = 466
integer y = 308
integer width = 855
integer height = 740
integer taborder = 50
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
boolean vscrollbar = true
string item[] = {"string","integer","long","date","datetime","time","decimal","object (use path-name)"}
borderstyle borderstyle = stylelowered!
end type

event constructor;this.selectitem( 1 )
end event

type cbx_null from checkbox within tabpage_list
integer x = 288
integer y = 212
integer width = 165
integer height = 80
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
long backcolor = 67108864
string text = "null"
end type

event clicked;tab_1.tabpage_list.sle_data.enabled = NOT checked
end event

type cb_sort from commandbutton within tabpage_list
string tag = "TT:Sort the list."
integer x = 539
integer y = 956
integer width = 402
integer height = 112
integer taborder = 40
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
string text = "sort"
end type

event clicked;
list.sort( thiswindow(), "cmplist" )
list_data( )

end event

type cb_multibench from commandbutton within tabpage_list
integer x = 978
integer y = 1112
integer width = 571
integer height = 84
integer taborder = 40
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
string text = "mbench (datastore)"
end type

event clicked;
anyiterator iter
uo_list llist
long l, i, loops[]
long gctime
string s
int li_val
datastore ds

nv_benchmark nv_bench

llist = create uo_list
gctime = GarbageCollectGetTimeLimit()
GarbageCollectSetTimeLimit(100000)

st_time.text = ""

split_to_array_of_longs(sle_testcount.text, '|', loops[])


for l = 1 to upperbound(loops[])
	iter = anyiterator_factory()
	list.purge( )
	GarbageCollect ( )
	nv_bench.start( )
	st_time.text += string(loops[l]) + ":anyiterator : "
	for i = 1 to loops[l]
//		ds = create datastore
//		iter._add(ds)
		//iter._add(string(i))
		iter._add(i)
	next
	st_time.text += string(nv_bench.mark()) + "/"
	do while iter.hasnext( )
		//s = ""
		//ds = iter.getnext()
		//destroy ds
		li_val = iter.getnext( )
	loop
	st_time.text += string(nv_bench.stop())// + " s"
	
	yield()
	
	st_time.text += "~r~nuo_list : " 
	GarbageCollect ( )
	nv_bench.start( )
	for i = 1 to loops[l]
		//ds = create datastore
		//list.append(ds)
		//list.append( string(i))
		list.append(i)
	next
	st_time.text += string(nv_bench.mark()) + "/"
	do while list.hasnext( )
		li_val = list.getandnext( )
		//s = ""
		//ds = list.getnext( )
		//destroy ds
	loop
	st_time.text += string(nv_bench.stop()) + "$"
next

GarbageCollectSetTimeLimit(gctime)
destroy llist

messagebox("bench", "done")

end event

type sle_data from singlelineedit within tabpage_list
integer x = 466
integer y = 208
integer width = 1179
integer height = 84
integer taborder = 30
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
string text = "none"
borderstyle borderstyle = stylelowered!
boolean hideselection = false
end type

type st_2 from statictext within tabpage_list
integer x = 119
integer y = 208
integer width = 210
integer height = 84
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
long backcolor = 67108864
string text = "data"
boolean focusrectangle = false
end type

type cb_prepend from commandbutton within tabpage_list
string tag = "TT:Add at the start of list."
integer x = 114
integer y = 444
integer width = 402
integer height = 112
integer taborder = 40
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
string text = "prepend"
end type

event clicked;
list.prepend( get_data() )

list_data( )

end event

type cb_get from commandbutton within tabpage_list
string tag = "TT:Get value at the given index (if any) or current internal index of list."
integer x = 539
integer y = 444
integer width = 402
integer height = 112
integer taborder = 30
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
string text = "get / get at"
end type

event clicked;any t

if sle_index.text <> "" then
	t = list.getat( long(sle_index.text))
else
	t = list.get()
end if

parent.event show_data(t)

end event

type cb_delete from commandbutton within tabpage_list
string tag = "TT:Remove element at the given index (if any) or current internal index of list."
integer x = 539
integer y = 700
integer width = 402
integer height = 112
integer taborder = 30
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
string text = "remove / at"
end type

event clicked;if sle_index.text <> "" then
	list.removeat( long(sle_index.text))
else
	list.remove()
end if

list_data( )

end event

type cb_obj from commandbutton within tabpage_list
integer x = 110
integer y = 1308
integer width = 402
integer height = 112
integer taborder = 30
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
string text = "test add/get"
end type

event clicked;//
//OutputDebugString("0")
//uo_hash hash
//
//hash = create uo_hash
//boolean res
//
//str_test val
//
//
//
////OutputDebugString("1")
////OutputDebugString(" ajout 1" + string(res ))
//val.l_val = 123
//val.s_val = "valeur no 1"
//res = hash.of_add( "1111111", val)
//messagebox("ajout 1", string(res))
//
//val.l_val = 42
//val.s_val = "valeur en deuxieme"
//res = hash.of_add( "2222222", val)
//messagebox("ajout 2", string(res))
//
//val.l_val = 99
//val.s_val = "valeur en 3"
//res = hash.of_add( "1111110", val)
//messagebox("ajout 3", string(res))
//
////====================================
//
//any ret_val
//str_test val2
//ret_val = hash.of_get("1111111")
//if isnull(ret_val) then
//	messagebox("get 1", "null")
//else
//	val2 = ret_val
//	messagebox("get 1", string(val2.l_val) + " / " + val2.s_val)
//end if
//
//ret_val = hash.of_get("1111110")
//if isnull(ret_val) then
//	messagebox("get 3", "null")
//else
//	val2 = ret_val
//	messagebox("get 3", string(val2.l_val) + " / " + val2.s_val)
//end if
//
//ret_val = hash.of_get("123456")
//if isnull(ret_val) then
//	messagebox("get 4", "null")
//else
//	val2 = ret_val
//	messagebox("get 4", string(val2.l_val) + " / " + val2.s_val)
//end if
//
//
//ret_val = hash.of_get("2222222")
//if isnull(ret_val) then
//	messagebox("get 2", "null")
//else
//	val2 = ret_val
//	messagebox("get 2", string(val2.l_val) + " / " + val2.s_val)
//end if
//
//ret_val = hash.of_get("1111110")
//if isnull(ret_val) then
//	messagebox("get 3", "null")
//else
//	val2 = ret_val
//	messagebox("get 3", string(val2.l_val) + " / " + val2.s_val)
//end if
//
//
//if isvalid(hash) then destroy hash
//
end event

type cb_1 from commandbutton within tabpage_list
integer x = 110
integer y = 1176
integer width = 402
integer height = 112
integer taborder = 30
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
string text = "debugstring"
end type

event clicked;outputdebugstring( "foo...bar")

end event

type st_count from statictext within tabpage_list
integer x = 1879
integer y = 16
integer width = 393
integer height = 68
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
long backcolor = 67108864
string text = "items"
boolean focusrectangle = false
end type

type cb_purge from commandbutton within tabpage_list
string tag = "TT:Remove all elements of list."
integer x = 539
integer y = 828
integer width = 402
integer height = 112
integer taborder = 40
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
string text = "purge"
end type

event clicked;
list.purge()
list_data( )

end event

type cb_set from commandbutton within tabpage_list
string tag = "TT:Set value at the given index (if any) or current internal index of list."
integer x = 539
integer y = 572
integer width = 402
integer height = 112
integer taborder = 30
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
string text = "set / set at"
end type

event clicked;
if sle_index.text <> "" then
	list.setat( long(sle_index.text), get_data()  )
else
	list.set(get_data() )
end if

list_data( )

end event

type lb_values from listbox within tabpage_list
integer x = 1870
integer y = 124
integer width = 1056
integer height = 1316
integer taborder = 20
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = fixed!
fontfamily fontfamily = modern!
string facename = "Courier New"
long textcolor = 33554432
boolean hscrollbar = true
boolean vscrollbar = true
boolean sorted = false
borderstyle borderstyle = stylelowered!
end type

event selectionchanged;
if index > 0 then
	sle_index.text = string(index)
	any la_val
	la_val = list.getat(index)
	parent.event show_data(la_val)
end if
end event

type st_max from statictext within tabpage_list
integer x = 2437
integer y = 16
integer width = 466
integer height = 68
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
long backcolor = 67108864
string text = "max"
boolean focusrectangle = false
end type

type st_idx from statictext within tabpage_list
integer x = 119
integer y = 104
integer width = 526
integer height = 84
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
long backcolor = 67108864
string text = "index (if applicable)"
boolean focusrectangle = false
end type

type sle_index from singlelineedit within tabpage_list
integer x = 658
integer y = 92
integer width = 402
integer height = 92
integer taborder = 20
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
borderstyle borderstyle = stylelowered!
end type

type pb_rewind from picturebutton within tabpage_list
integer x = 1006
integer y = 664
integer width = 110
integer height = 96
integer taborder = 30
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
string picturename = "VCRFirst!"
alignment htextalign = left!
boolean map3dcolors = true
end type

event clicked;list.rewind( )
cbx_hasnext.checked = list.hasnext()
list_data( )

end event

type pb_prev from picturebutton within tabpage_list
integer x = 1138
integer y = 664
integer width = 110
integer height = 96
integer taborder = 30
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
string picturename = "VCRPrior!"
alignment htextalign = left!
boolean map3dcolors = true
end type

event clicked;any t

t = list.getprevious( )
tab_1.tabpage_list.event show_data(t)

cbx_hasnext.checked = list.hasnext()

list_data( )

end event

type pb_next from picturebutton within tabpage_list
integer x = 1271
integer y = 664
integer width = 110
integer height = 96
integer taborder = 30
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
string picturename = "VCRNext!"
alignment htextalign = left!
boolean map3dcolors = true
end type

event clicked;any t

t = list.getnext()
tab_1.tabpage_list.event show_data(t)

cbx_hasnext.checked = list.hasnext()
list_data( )

end event

type cb_first from commandbutton within tabpage_list
integer x = 965
integer y = 444
integer width = 402
integer height = 112
integer taborder = 30
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
string text = "get first"
end type

event clicked;any t

t = list.getfirst()
parent.event show_data(t)
end event

type cb_last from commandbutton within tabpage_list
integer x = 1390
integer y = 444
integer width = 402
integer height = 112
integer taborder = 30
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
string text = "get last"
end type

event clicked;any t

t = list.getlast()
parent.event show_data(t)

end event

type cb_append from commandbutton within tabpage_list
string tag = "TT:Add at the end of list."
integer x = 114
integer y = 572
integer width = 402
integer height = 112
integer taborder = 20
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
string text = "append"
end type

event clicked;
list.append( get_data()  )

list_data( )

end event

type cb_insert from commandbutton within tabpage_list
string tag = "TT:Insert at the current internal index of list."
integer x = 114
integer y = 700
integer width = 402
integer height = 112
integer taborder = 20
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
string text = "insert"
end type

event clicked;
list.inserthere(get_data() )

list_data( )

end event

type cb_before from commandbutton within tabpage_list
string tag = "TT:Insert before the given index of list."
integer x = 114
integer y = 828
integer width = 402
integer height = 112
integer taborder = 20
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
string text = "insert before"
end type

event clicked;if sle_index.text <> "" then
	list.insertbefore( long(sle_index.text), get_data()  )
end if

list_data( )

end event

type cb_after from commandbutton within tabpage_list
string tag = "TT:Insert after the given index of list."
integer x = 114
integer y = 956
integer width = 402
integer height = 112
integer taborder = 20
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
string text = "insert after"
end type

event clicked;if sle_index.text <> "" then
	list.insertafter( long(sle_index.text), get_data() )
end if

list_data( )

end event

type cbx_hasnext from checkbox within tabpage_list
integer x = 1408
integer y = 672
integer width = 379
integer height = 80
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
long backcolor = 67108864
boolean enabled = false
string text = "HasNext ?"
end type

type sle_testcount from singlelineedit within tabpage_list
integer x = 581
integer y = 1200
integer width = 293
integer height = 84
integer taborder = 20
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
string text = "10000"
borderstyle borderstyle = stylelowered!
end type

event rbuttondown;
if keydown(KeyControl!) then
	this.text = is_loops
end if

end event

type st_x from statictext within tabpage_list
integer x = 896
integer y = 1208
integer width = 73
integer height = 64
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
long backcolor = 67108864
string text = "X"
alignment alignment = center!
boolean focusrectangle = false
end type

type cb_bench from commandbutton within tabpage_list
integer x = 978
integer y = 1200
integer width = 571
integer height = 84
integer taborder = 20
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
string text = "bench (datastore)"
end type

event clicked;
anyiterator iter
uo_list llist
long i, loops
long gctime
string s
datastore ds

llist = create uo_list
gctime = GarbageCollectGetTimeLimit()
GarbageCollectSetTimeLimit(100000)

st_time.text = ""

loops = long(sle_testcount.text )

nv_benchmark nv_bench

st_time.text += "anyiterator : "
for i = 1 to loops
	ds = create datastore
	//iter._add(string(i))
	iter._add(ds)
next
st_time.text += string(nv_bench.mark()) + "/"
do while iter.hasnext( )
	//s = ""
	ds = iter.getnext()
	destroy ds
loop
st_time.text += string(nv_bench.mark())// + " s"

yield()

st_time.text += "~r~nuo_list : " 
for i = 1 to loops
	ds = create datastore
	//list.append( string(i))
	list.append(ds)
next
st_time.text += string(nv_bench.mark()) + "/"
if list.hasnext( ) then
	ds = list.get()
	destroy ds
	do while list.hasnext( )
		//s = ""
		ds = list.getnext( )
		destroy ds
	loop
end if
st_time.text += string(nv_bench.mark())// + " s"


GarbageCollectSetTimeLimit(gctime)
destroy llist

end event

type st_time from statictext within tabpage_list
integer x = 576
integer y = 1304
integer width = 1280
integer height = 140
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
long backcolor = 67108864
boolean focusrectangle = false
end type

event doubleclicked;string ls_text

ls_text = st_time.text
ls_text = fastreplaceall(ls_text, ":" , "~t")
ls_text = fastreplaceall(ls_text, "/" , "~t")
ls_text = fastreplaceall(ls_text, "~r~n" , "~t")
ls_text = fastreplaceall(ls_text, "$", "~r~n")
clipboard(ls_text)

end event

type gb_1 from groupbox within tabpage_list
integer x = 59
integer y = 24
integer width = 1605
integer height = 400
integer taborder = 10
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
long backcolor = 67108864
string text = "none"
end type

type gb_3 from groupbox within tabpage_list
integer x = 969
integer y = 580
integer width = 827
integer height = 232
integer taborder = 50
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
long backcolor = 67108864
string text = "Internal index"
end type

type tabpage_vector from userobject within tab_1
event create ( )
event destroy ( )
event show_data ( any aa_val )
integer x = 18
integer y = 112
integer width = 2985
integer height = 1520
long backcolor = 67108864
string text = "uo_vector"
long tabtextcolor = 33554432
long picturemaskcolor = 536870912
ddlb_sort_datatype_vect ddlb_sort_datatype_vect
st_4 st_4
ddlb_datatype_vect ddlb_datatype_vect
cbx_null_vect cbx_null_vect
cb_sort_v cb_sort_v
cb_multibench_v cb_multibench_v
cbx_reserve cbx_reserve
st_time_v st_time_v
cb_bench_v cb_bench_v
st_6 st_6
sle_testcount_v sle_testcount_v
cbx_hasnext_v cbx_hasnext_v
cb_after_v cb_after_v
cb_before_v cb_before_v
cb_insert_v cb_insert_v
cb_append_v cb_append_v
cb_last_v cb_last_v
cb_first_v cb_first_v
pb_next_v pb_next_v
pb_prev_v pb_prev_v
pb_rewind_v pb_rewind_v
sle_index_v sle_index_v
st_5 st_5
st_max_v st_max_v
lb_values_v lb_values_v
cb_set_v cb_set_v
cb_purge_v cb_purge_v
st_count_v st_count_v
cb_debug_v cb_debug_v
cb_5 cb_5
cb_delete_v cb_delete_v
cb_get_v cb_get_v
cb_prepend_v cb_prepend_v
st_1 st_1
sle_data_v sle_data_v
gb_2 gb_2
gb_index gb_index
end type

on tabpage_vector.create
this.ddlb_sort_datatype_vect=create ddlb_sort_datatype_vect
this.st_4=create st_4
this.ddlb_datatype_vect=create ddlb_datatype_vect
this.cbx_null_vect=create cbx_null_vect
this.cb_sort_v=create cb_sort_v
this.cb_multibench_v=create cb_multibench_v
this.cbx_reserve=create cbx_reserve
this.st_time_v=create st_time_v
this.cb_bench_v=create cb_bench_v
this.st_6=create st_6
this.sle_testcount_v=create sle_testcount_v
this.cbx_hasnext_v=create cbx_hasnext_v
this.cb_after_v=create cb_after_v
this.cb_before_v=create cb_before_v
this.cb_insert_v=create cb_insert_v
this.cb_append_v=create cb_append_v
this.cb_last_v=create cb_last_v
this.cb_first_v=create cb_first_v
this.pb_next_v=create pb_next_v
this.pb_prev_v=create pb_prev_v
this.pb_rewind_v=create pb_rewind_v
this.sle_index_v=create sle_index_v
this.st_5=create st_5
this.st_max_v=create st_max_v
this.lb_values_v=create lb_values_v
this.cb_set_v=create cb_set_v
this.cb_purge_v=create cb_purge_v
this.st_count_v=create st_count_v
this.cb_debug_v=create cb_debug_v
this.cb_5=create cb_5
this.cb_delete_v=create cb_delete_v
this.cb_get_v=create cb_get_v
this.cb_prepend_v=create cb_prepend_v
this.st_1=create st_1
this.sle_data_v=create sle_data_v
this.gb_2=create gb_2
this.gb_index=create gb_index
this.Control[]={this.ddlb_sort_datatype_vect,&
this.st_4,&
this.ddlb_datatype_vect,&
this.cbx_null_vect,&
this.cb_sort_v,&
this.cb_multibench_v,&
this.cbx_reserve,&
this.st_time_v,&
this.cb_bench_v,&
this.st_6,&
this.sle_testcount_v,&
this.cbx_hasnext_v,&
this.cb_after_v,&
this.cb_before_v,&
this.cb_insert_v,&
this.cb_append_v,&
this.cb_last_v,&
this.cb_first_v,&
this.pb_next_v,&
this.pb_prev_v,&
this.pb_rewind_v,&
this.sle_index_v,&
this.st_5,&
this.st_max_v,&
this.lb_values_v,&
this.cb_set_v,&
this.cb_purge_v,&
this.st_count_v,&
this.cb_debug_v,&
this.cb_5,&
this.cb_delete_v,&
this.cb_get_v,&
this.cb_prepend_v,&
this.st_1,&
this.sle_data_v,&
this.gb_2,&
this.gb_index}
end on

on tabpage_vector.destroy
destroy(this.ddlb_sort_datatype_vect)
destroy(this.st_4)
destroy(this.ddlb_datatype_vect)
destroy(this.cbx_null_vect)
destroy(this.cb_sort_v)
destroy(this.cb_multibench_v)
destroy(this.cbx_reserve)
destroy(this.st_time_v)
destroy(this.cb_bench_v)
destroy(this.st_6)
destroy(this.sle_testcount_v)
destroy(this.cbx_hasnext_v)
destroy(this.cb_after_v)
destroy(this.cb_before_v)
destroy(this.cb_insert_v)
destroy(this.cb_append_v)
destroy(this.cb_last_v)
destroy(this.cb_first_v)
destroy(this.pb_next_v)
destroy(this.pb_prev_v)
destroy(this.pb_rewind_v)
destroy(this.sle_index_v)
destroy(this.st_5)
destroy(this.st_max_v)
destroy(this.lb_values_v)
destroy(this.cb_set_v)
destroy(this.cb_purge_v)
destroy(this.st_count_v)
destroy(this.cb_debug_v)
destroy(this.cb_5)
destroy(this.cb_delete_v)
destroy(this.cb_get_v)
destroy(this.cb_prepend_v)
destroy(this.st_1)
destroy(this.sle_data_v)
destroy(this.gb_2)
destroy(this.gb_index)
end on

event show_data(any aa_val);
show_data(aa_val, sle_data_v, ddlb_datatype_vect)

end event

type ddlb_sort_datatype_vect from dropdownlistbox within tabpage_vector
integer x = 978
integer y = 964
integer width = 498
integer height = 556
integer taborder = 70
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
boolean sorted = false
boolean vscrollbar = true
string item[] = {"string","integer","long","date","datetime","time","decimal","object (use path-name)"}
borderstyle borderstyle = stylelowered!
end type

event constructor;this.selectitem( 1 )
end event

type st_4 from statictext within tabpage_vector
integer x = 114
integer y = 320
integer width = 343
integer height = 68
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
long backcolor = 67108864
string text = "data type:"
boolean focusrectangle = false
end type

type ddlb_datatype_vect from dropdownlistbox within tabpage_vector
integer x = 466
integer y = 308
integer width = 855
integer height = 740
integer taborder = 60
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
boolean vscrollbar = true
string item[] = {"string","integer","long","date","datetime","time","decimal","object (use path-name)"}
borderstyle borderstyle = stylelowered!
end type

event constructor;this.selectitem( 1 )
end event

type cbx_null_vect from checkbox within tabpage_vector
integer x = 288
integer y = 212
integer width = 165
integer height = 80
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
long backcolor = 67108864
string text = "null"
end type

event clicked;tab_1.tabpage_vector.sle_data_v.enabled = NOT checked
end event

type cb_sort_v from commandbutton within tabpage_vector
integer x = 539
integer y = 956
integer width = 402
integer height = 112
integer taborder = 30
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
string text = "sort"
end type

event clicked;
vector.sort( thiswindow(), "cmpvector")
list_data( )

end event

type cb_multibench_v from commandbutton within tabpage_vector
integer x = 978
integer y = 1112
integer width = 571
integer height = 84
integer taborder = 50
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
string text = "mbench (datastore)"
end type

event clicked;
anyiterator iter
uo_vector lvector
long l, i, loops[]
long gctime
string s
int li_val
datastore ds

nv_benchmark nv_bench

lvector = create uo_vector
gctime = GarbageCollectGetTimeLimit()
GarbageCollectSetTimeLimit(100000)

st_time_v.text = ""

split_to_array_of_longs(sle_testcount_v.text, '|', loops[])

if cbx_reserve.checked then sle_data_v.text = "reservation (" + string(loops[upperbound(loops)]) + ") = " + string( vector.reserve( loops[upperbound(loops)] ))

for l = 1 to upperbound(loops[])
	iter = anyiterator_factory()
	lvector.purge( )
	GarbageCollect ( )
	nv_bench.start( )
	st_time_v.text += string(loops[l]) + ":anyiterator : "
	for i = 1 to loops[l]
//		ds = create datastore
//		iter._add(ds)
		//iter._add(string(i))
		iter._add(i)
	next
	st_time_v.text += string(nv_bench.mark()) + "/"
	do while iter.hasnext( )
		//s = ""
		//ds = iter.getnext()
		//destroy ds
		li_val = iter.getnext( )
	loop
	st_time_v.text += string(nv_bench.stop())// + " s"
	
	yield()
	
	st_time_v.text += "~r~nuo_vector : " 
	GarbageCollect ( )
	nv_bench.start( )
	for i = 1 to loops[l]
		//ds = create datastore
		//list.append(ds)
		//list.append( string(i))
		lvector.append(i)
	next
	st_time_v.text += string(nv_bench.mark()) + "/"
	do while lvector.hasnext( )
		li_val = lvector.getandnext( )
		//s = ""
		//ds = list.getnext( )
		//destroy ds
	loop
	st_time_v.text += string(nv_bench.stop()) + "$"
next

GarbageCollectSetTimeLimit(gctime)
destroy lvector

messagebox("bench", "done")

end event

type cbx_reserve from checkbox within tabpage_vector
integer x = 1518
integer y = 1204
integer width = 306
integer height = 80
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
long backcolor = 67108864
string text = "reserve"
end type

type st_time_v from statictext within tabpage_vector
integer x = 576
integer y = 1304
integer width = 1280
integer height = 140
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
long backcolor = 67108864
boolean focusrectangle = false
end type

event doubleclicked;string ls_text

ls_text = st_time_v.text
ls_text = fastreplaceall(ls_text, ":" , "~t")
ls_text = fastreplaceall(ls_text, "/" , "~t")
ls_text = fastreplaceall(ls_text, "~r~n" , "~t")
ls_text = fastreplaceall(ls_text, "$", "~r~n")
clipboard(ls_text)

end event

type cb_bench_v from commandbutton within tabpage_vector
integer x = 978
integer y = 1200
integer width = 521
integer height = 84
integer taborder = 30
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
string text = "bench (datastore)"
end type

event clicked;
anyiterator iter
uo_vector lvector
long i, loops
long gctime
string s
datastore ds

lvector = create uo_vector
gctime = GarbageCollectGetTimeLimit()
GarbageCollectSetTimeLimit(1000000)

st_time_v.text = ""

loops = long(sle_testcount_v.text )

if cbx_reserve.checked then sle_data_v.text = "reservation (" + string(loops) + ") = " + string( vector.reserve( loops ))

nv_benchmark nv_bench

st_time_v.text += "anyiterator : "
for i = 1 to loops
	ds = create datastore
	//iter._add(string(i))
	iter._add(ds)
next
st_time_v.text += string(nv_bench.mark()) + "/"
do while iter.hasnext( )
	//s = ""
	ds = iter.getnext()
	destroy ds
loop
st_time_v.text += string(nv_bench.mark())// + " s"

yield()

st_time_v.text += "~r~nuo_vector : " 
for i = 1 to loops
	ds = create datastore
	//list.append( string(i))
	lvector.append(ds)
next
st_time_v.text += string(nv_bench.mark()) + "/"
if lvector.hasnext( ) then
	ds = lvector.get()
	destroy ds
	do while lvector.hasnext( )
		//s = ""
		ds = lvector.getnext( )
		destroy ds
	loop
end if
st_time_v.text += string(nv_bench.mark())// + " s"


GarbageCollectSetTimeLimit(gctime)
destroy lvector

end event

type st_6 from statictext within tabpage_vector
integer x = 896
integer y = 1208
integer width = 73
integer height = 64
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
long backcolor = 67108864
string text = "X"
alignment alignment = center!
boolean focusrectangle = false
end type

type sle_testcount_v from singlelineedit within tabpage_vector
integer x = 581
integer y = 1200
integer width = 293
integer height = 84
integer taborder = 30
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
string text = "10000"
borderstyle borderstyle = stylelowered!
end type

event rbuttondown;if keydown(KeyControl!) then
	this.text = is_loops
end if

end event

type cbx_hasnext_v from checkbox within tabpage_vector
integer x = 1408
integer y = 672
integer width = 379
integer height = 80
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
long backcolor = 67108864
boolean enabled = false
string text = "HasNext ?"
end type

type cb_after_v from commandbutton within tabpage_vector
integer x = 114
integer y = 956
integer width = 402
integer height = 112
integer taborder = 30
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
string text = "insert after"
end type

event clicked;if sle_index_v.text <> "" then
	vector.insertafter( long(sle_index_v.text), get_data( ) )
end if

list_data( )

end event

type cb_before_v from commandbutton within tabpage_vector
integer x = 114
integer y = 828
integer width = 402
integer height = 112
integer taborder = 40
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
string text = "insert before"
end type

event clicked;if sle_index_v.text <> "" then
	vector.insertbefore( long(sle_index_v.text), get_data( ) )
end if

list_data( )

end event

type cb_insert_v from commandbutton within tabpage_vector
integer x = 114
integer y = 700
integer width = 402
integer height = 112
integer taborder = 50
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
string text = "insert"
end type

event clicked;
vector.inserthere(get_data( ))

list_data( )

end event

type cb_append_v from commandbutton within tabpage_vector
integer x = 114
integer y = 572
integer width = 402
integer height = 112
integer taborder = 40
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
string text = "append"
end type

event clicked;
vector.append(get_data( ) )

list_data( )

end event

type cb_last_v from commandbutton within tabpage_vector
integer x = 1390
integer y = 444
integer width = 402
integer height = 112
integer taborder = 40
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
string text = "get last"
end type

event clicked;any t

t = vector.getlast()
parent.event show_data(t)

end event

type cb_first_v from commandbutton within tabpage_vector
integer x = 965
integer y = 444
integer width = 402
integer height = 112
integer taborder = 50
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
string text = "get first"
end type

event clicked;any t

t = vector.getfirst()
parent.event show_data(t)

end event

type pb_next_v from picturebutton within tabpage_vector
integer x = 1271
integer y = 664
integer width = 110
integer height = 96
integer taborder = 40
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
string picturename = "VCRNext!"
alignment htextalign = left!
boolean map3dcolors = true
end type

event clicked;any t

t = vector.getnext()
sle_data_v.text = tostring(t)

cbx_hasnext_v.checked = vector.hasnext()
list_data( )

end event

type pb_prev_v from picturebutton within tabpage_vector
integer x = 1138
integer y = 664
integer width = 110
integer height = 96
integer taborder = 40
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
string picturename = "VCRPrior!"
alignment htextalign = left!
boolean map3dcolors = true
end type

event clicked;any t

t = vector.getprevious( )
sle_data_v.text = tostring(t)
cbx_hasnext_v.checked = vector.hasnext()

list_data( )

end event

type pb_rewind_v from picturebutton within tabpage_vector
integer x = 1006
integer y = 664
integer width = 110
integer height = 96
integer taborder = 40
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
string picturename = "VCRFirst!"
alignment htextalign = left!
boolean map3dcolors = true
end type

event clicked;vector.rewind( )
cbx_hasnext_v.checked = vector.hasnext()
list_data( )

end event

type sle_index_v from singlelineedit within tabpage_vector
integer x = 658
integer y = 92
integer width = 402
integer height = 92
integer taborder = 30
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
borderstyle borderstyle = stylelowered!
end type

type st_5 from statictext within tabpage_vector
integer x = 119
integer y = 104
integer width = 526
integer height = 84
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
long backcolor = 67108864
string text = "index (if applicable)"
boolean focusrectangle = false
end type

type st_max_v from statictext within tabpage_vector
integer x = 2437
integer y = 16
integer width = 466
integer height = 68
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
long backcolor = 67108864
string text = "max"
boolean focusrectangle = false
end type

type lb_values_v from listbox within tabpage_vector
integer x = 1870
integer y = 124
integer width = 1056
integer height = 1316
integer taborder = 30
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = fixed!
fontfamily fontfamily = modern!
string facename = "Courier New"
long textcolor = 33554432
boolean hscrollbar = true
boolean vscrollbar = true
boolean sorted = false
borderstyle borderstyle = stylelowered!
end type

event selectionchanged;
if index > 0 then
	sle_index_v.text = string(index)
	any la_val
	la_val = vector.getat(index)
	parent.event show_data(la_val)
end if
end event

type cb_set_v from commandbutton within tabpage_vector
integer x = 539
integer y = 572
integer width = 402
integer height = 112
integer taborder = 40
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
string text = "set / set at"
end type

event clicked;
if sle_index_v.text <> "" then
	vector.setat( long(sle_index_v.text), get_data( ) )
else
	vector.set(get_data( ))
end if

list_data( )

end event

type cb_purge_v from commandbutton within tabpage_vector
integer x = 539
integer y = 828
integer width = 402
integer height = 112
integer taborder = 50
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
string text = "purge"
end type

event clicked;
vector.purge()
list_data( )

end event

type st_count_v from statictext within tabpage_vector
integer x = 1879
integer y = 16
integer width = 393
integer height = 68
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
long backcolor = 67108864
string text = "items"
boolean focusrectangle = false
end type

type cb_debug_v from commandbutton within tabpage_vector
integer x = 110
integer y = 1176
integer width = 402
integer height = 112
integer taborder = 40
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
string text = "debugstring"
end type

event clicked;outputdebugstring("foo...bar")

end event

type cb_5 from commandbutton within tabpage_vector
integer x = 110
integer y = 1308
integer width = 402
integer height = 112
integer taborder = 40
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
string text = "test add/get"
end type

event clicked;//
//OutputDebugString("0")
//uo_hash hash
//
//hash = create uo_hash
//boolean res
//
//str_test val
//
//
//
////OutputDebugString("1")
////OutputDebugString(" ajout 1" + string(res ))
//val.l_val = 123
//val.s_val = "valeur no 1"
//res = hash.of_add( "1111111", val)
//messagebox("ajout 1", string(res))
//
//val.l_val = 42
//val.s_val = "valeur en deuxieme"
//res = hash.of_add( "2222222", val)
//messagebox("ajout 2", string(res))
//
//val.l_val = 99
//val.s_val = "valeur en 3"
//res = hash.of_add( "1111110", val)
//messagebox("ajout 3", string(res))
//
////====================================
//
//any ret_val
//str_test val2
//ret_val = hash.of_get("1111111")
//if isnull(ret_val) then
//	messagebox("get 1", "null")
//else
//	val2 = ret_val
//	messagebox("get 1", string(val2.l_val) + " / " + val2.s_val)
//end if
//
//ret_val = hash.of_get("1111110")
//if isnull(ret_val) then
//	messagebox("get 3", "null")
//else
//	val2 = ret_val
//	messagebox("get 3", string(val2.l_val) + " / " + val2.s_val)
//end if
//
//ret_val = hash.of_get("123456")
//if isnull(ret_val) then
//	messagebox("get 4", "null")
//else
//	val2 = ret_val
//	messagebox("get 4", string(val2.l_val) + " / " + val2.s_val)
//end if
//
//
//ret_val = hash.of_get("2222222")
//if isnull(ret_val) then
//	messagebox("get 2", "null")
//else
//	val2 = ret_val
//	messagebox("get 2", string(val2.l_val) + " / " + val2.s_val)
//end if
//
//ret_val = hash.of_get("1111110")
//if isnull(ret_val) then
//	messagebox("get 3", "null")
//else
//	val2 = ret_val
//	messagebox("get 3", string(val2.l_val) + " / " + val2.s_val)
//end if
//
//
//if isvalid(hash) then destroy hash
//
end event

type cb_delete_v from commandbutton within tabpage_vector
integer x = 539
integer y = 700
integer width = 402
integer height = 112
integer taborder = 50
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
string text = "remove / at"
end type

event clicked;if sle_index_v.text <> "" then
	vector.removeat( long(sle_index_v.text))
else
	vector.remove()
end if

list_data( )

end event

type cb_get_v from commandbutton within tabpage_vector
integer x = 539
integer y = 444
integer width = 402
integer height = 112
integer taborder = 40
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
string text = "get / get at"
end type

event clicked;any t

if sle_index_v.text <> "" then
	t = vector.getat( long(sle_index_v.text))
else
	t = vector.get()
end if

parent.event show_data(t)

end event

type cb_prepend_v from commandbutton within tabpage_vector
integer x = 114
integer y = 444
integer width = 402
integer height = 112
integer taborder = 50
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
string text = "prepend"
end type

event clicked;
vector.prepend( get_data( ) )

list_data( )

end event

type st_1 from statictext within tabpage_vector
integer x = 119
integer y = 208
integer width = 210
integer height = 84
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
long backcolor = 67108864
string text = "data"
boolean focusrectangle = false
end type

type sle_data_v from singlelineedit within tabpage_vector
integer x = 466
integer y = 208
integer width = 1179
integer height = 84
integer taborder = 40
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
string text = "none"
borderstyle borderstyle = stylelowered!
boolean hideselection = false
end type

type gb_2 from groupbox within tabpage_vector
integer x = 59
integer y = 24
integer width = 1605
integer height = 400
integer taborder = 20
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
long backcolor = 67108864
string text = "pbx version"
end type

type gb_index from groupbox within tabpage_vector
integer x = 969
integer y = 580
integer width = 827
integer height = 232
integer taborder = 40
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
long backcolor = 67108864
string text = "Internal index"
end type

